# 近隣情報マッピングアプリ - プロジェクト状況

## 現在の状況: フルスタック稼働中システム

### 稼働中のシステム構成
- **フロントエンド**: React + TypeScript (localhost:3001) - 完全動作中
- **バックエンドAPI**: Go言語 (localhost:8081) - 6エンドポイント稼働中
- **データベース**: PostgreSQL + PostGIS (localhost:5432) - サンプルデータ投入済み
- **連携状況**: フロントエンド ↔ バックエンド完全連携済み

### 実装完了済み機能
- **6つのAPIエンドポイント**:
  - `GET /v1/areas` - エリア一覧取得
  - `GET /v1/areas/{ward_code}/{town_code}/schools` - 学校データ取得
  - `GET /v1/areas/{ward_code}/{town_code}/crimes` - 犯罪データ取得
  - `GET /v1/schools/{id}/safety-score` - 個別学校安全スコア
  - `GET /v1/areas/{ward_code}/{town_code}/safety-scores` - 全学校安全スコア
  - `GET /health` - ヘルスチェック

- **フロントエンド機能**:
  - 地図表示（Leaflet）、マーカー表示、レイヤー制御
  - 検索・フィルタリング（学校種別、犯罪種別、安全スコア範囲）
  - 統計ダッシュボード（Chart.js）
  - CSV/PDF エクスポート機能
  - レスポンシブデザイン

- **データベース機能**:
  - PostGIS 空間解析（半径500m圏内犯罪件数計算）
  - 安全スコア自動計算（0-100点スケール）
  - 世田谷区・新宿区のサンプルデータ投入済み

## Phase 1: データ拡張とパフォーマンス改善（最優先）

### 1. 実データ大幅拡張
- **現状**: 世田谷区・新宿区の限定サンプルデータ
- **目標**: 東京23区全体のデータ投入
- **作業内容**:
  - 文部科学省 学校基本調査データの取得・変換
  - 警視庁公開統計データの取得・正規化
  - 残り21区のデータベース投入

### 2. パフォーマンス最適化
- **大量データ対応**: マーカークラスタリング実装
- **データベース最適化**: 空間インデックス調整、クエリ改善
- **フロントエンド最適化**: 仮想化、遅延ロード実装

### 3. ETLパイプライン復活
- **Apache Airflow環境** の再構築
- **自動データ更新処理** の実装
- **Excel/CSV → Parquet → PostGIS** パイプライン構築

## Phase 2: 機能強化（中優先度）

### 4. 高度な地図機能
- **ヒートマップ表示** の高度化
- **実際のGeoJSON境界データ** 統合
- **ルート検索・最適経路提案** 機能
- **時系列アニメーション** 表示

### 5. 統計・分析ダッシュボード拡張
- **時系列分析**（犯罪トレンド表示）
- **地域間比較機能**
- **予測モデル**の導入
- **より詳細な安全スコア**算出アルゴリズム

### 6. ユーザビリティ向上
- **モバイル対応強化**
- **PWA対応**（オフライン機能）
- **アクセシビリティ改善**
- **多言語対応**（日本語・英語）

## Phase 3: 本格運用基盤（低優先度）

### 7. クラウド展開
- **AWS ECS/Fargate** への移行
- **RDS PostgreSQL** クラスタ構成
- **CloudFront + S3** フロントエンド配信
- **CI/CDパイプライン** 構築

### 8. 運用監視・セキュリティ
- **CloudWatch** ログ監視
- **セキュリティ対策** 強化
- **バックアップ・災害復旧** 戦略
- **API認証・レート制限** 機能

## 技術スタック詳細

### 稼働中技術構成
- **フロントエンド**: TypeScript 5.x, React 18, Vite, Leaflet, Chart.js
- **バックエンド**: Go 1.21, Gorilla Mux, PostgreSQL Driver
- **データベース**: PostgreSQL 15 + PostGIS 3.3
- **インフラ**: Docker Compose
- **データ形式**: GeoJSON, 空間データ (SRID: 4326)

### 拡張予定技術
- **ETL**: Apache Airflow, Apache Spark
- **可視化**: D3.js 拡張
- **機械学習**: Python + scikit-learn
- **リアルタイム**: WebSocket + Redis

## 現在のシステム起動手順

```bash
# プロジェクトディレクトリ
cd /Users/ota-eita/Documents/work/gokinjo

# 1. データベース起動
docker-compose -f deployment/docker-compose.yml up -d

# 2. バックエンドAPI起動
cd api && go run cmd/simple-server/main.go

# 3. フロントエンド起動
cd frontend && npm run dev

# アクセス: http://localhost:3001
```

## データソース・リソース

### 確定済みデータソース
- **学校データ**: 文部科学省 学校基本調査 + 各区教育委員会公開データ
- **犯罪データ**: 警視庁「区市町村の町丁別、罪種別及び手口別認知件数」
- **地理データ**: 国土数値情報（行政区域・学校データ）
- **地図配信**: OpenStreetMap

### 商用検討中サービス
- **高品質地図**: MapTiler, Mapbox
- **ジオコーディング**: Google Maps API

## 直近の実行計画

### 今週実施項目
1. **追加サンプルデータ作成**: 渋谷区・港区データをSQL化
2. **マーカークラスタリング実装**: leaflet.markercluster導入
3. **ヒートマップ表示改善**: 設定調整・UX改善

### 来週実施項目
1. **実データ調査**: 文部科学省・警視庁データソース具体化
2. **ETL基盤準備**: Airflow Docker環境構築開始
3. **パフォーマンステスト**: 大量データでの動作検証

## プロジェクト評価

### 技術的成果
- **実証済みアーキテクチャ**: 空間データベース + フルスタックWeb
- **稼働実績**: 完全動作するデモ環境
- **拡張可能性**: モジュール化された設計

### ビジネス価値
- **コンセプト検証完了**: 学校×治安データ統合の有効性実証
- **デモ環境完成**: ステークホルダー向けプレゼン即座対応可能
- **技術検証完了**: PostGIS空間解析の実用性確認

---
**最終更新**: 2025-08-24  
**システム状態**: 完全稼働中  
**次のマイルストーン**: 23区データ拡張完了
